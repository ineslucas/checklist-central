<h1 class="main_title">checklist <br> central </h1>

<div class="filters-container">
  <div data-controller="filter" class="status-selected">all</div>
  <div class="status-unselected">gym</div>
  <div class="status-unselected">airport</div>
  <div class="status-unselected">other</div>
</div>

<%# class wrapping all instances of checklist %>
<div class="checklists-grid">
  <% @checklists.each do |checklist| %>

    <%# classes wrapping up title and description %>
    <div class="checklist_container <%= checklist.category %>">
      <%= link_to checklist_path(checklist) do %>

        <div class="row">
          <div class="col-10">
            <h2 class="checklist_title todo_list_title"><%= checklist.title %></h2>
            <%# todo_list_title class to be retired 🍓 %>
            <p class="checklist_description todo_list_sub_title"><%= checklist.description %></p>
          </div>
          <div class="col-2">
            <%= inline_svg 'link.svg' %>
          </div>
        </div>

        <div class="row">
          <div class="col-2">
            <div class="progress-container">
              <% completed_tasks_count = checklist.tasks.where(completed: true).count %>
              <% progress_percentage = (completed_tasks_count.to_f / checklist.tasks.count) * 100 %>

              <div class="progress-bar" style="height: <%= progress_percentage %>%;"></div>
            </div>
          </div>

          <div class="col-10">

            <% completed_tasks_count = checklist.tasks.where(completed: true).count %>
            <%= content_tag :p, style: "font-size: 20px; font-weight: 600; line-height: 1.15;" do %>
              <%= "#{completed_tasks_count} / #{checklist.tasks.count}" %><br>
              done
            <% end %>
          </div>
        </div>

      <% end %>
    </div>

  <% end %>
</div>

<div data-controller="toggle-new" data-action="click->toggle-new#toggleForm">
  <%= link_to new_checklist_path, class:"new_checklist_button", data: { turbo_frame: 'new_checklist' } do %>
    <%# Makes AJAX request, expecting a Turbo Frame with the ID new_checklist in the response. %>
    <%= inline_svg 'plus.svg' %>
  <% end %>
</div>

<%# New Checklist Form %>
<div id="new-checklist-form" class="d-none" data-toggle-new-target="form"> <!-- class list being toggled -->
  <%# this turbo frame tag might not be properly set %>
  <%= turbo_frame_tag 'new_checklist', src: new_checklist_path do %>
    <%# Loading form partial here, but do i even need a partial? %>
    <%= render 'form', checklist: @checklist %>
  <% end %>
</div>
